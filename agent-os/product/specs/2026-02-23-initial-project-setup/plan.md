# Plan: Initial Project Setup

## Goal

Set up the Vex CMS monorepo with minimal packages to enable admin shell development and testing.

## Phases

### Phase A: Monorepo + Minimal Packages

1. Initialize root (pnpm-workspace.yaml, .npmrc, package.json, turbo.json)
2. Create @vexcms/tsconfig (shared TypeScript configs)
3. Create @vexcms/core (minimal: defineConfig, VexConfig type)
4. Create @vexcms/admin (Layout, Sidebar, Header, createVexAdmin)

### Phase B: Test App

1. Run `pnpm create z3@latest test-app` in `apps/`
2. Add workspace dependencies to test-app
3. Create vex.config.ts
4. Create admin routes (/admin/*)
5. Verify shell renders

### Phase C: Convex Schema Integration

1. Add @vexcms/cli to test-app devDependencies
2. Run `vex sync` to generate schema files
3. Verify two-file schema approach works:
   - `convex/vex.schema.ts` — Auto-generated
   - `convex/schema.ts` — User-owned, imports from vex.schema
4. Test watch mode: `vex sync --watch`
5. Verify hot reloading when vex.config.ts changes

## Files Created

```
vex.git/dev/                         # workspace root
├── apps/
│   └── test-app/                    # z3 template + Vex
│       ├── vex.config.ts
│       └── src/app/admin/
│           ├── layout.tsx
│           └── page.tsx
│
├── packages/
│   ├── tsconfig/
│   │   ├── package.json
│   │   ├── base.json
│   │   ├── react-library.json
│   │   └── nextjs.json
│   │
│   ├── core/
│   │   ├── package.json
│   │   ├── tsconfig.json
│   │   ├── tsup.config.ts
│   │   └── src/index.ts
│   │
│   ├── ui/                          # @vexcms/ui (shared React)
│   │   ├── package.json
│   │   ├── tsconfig.json
│   │   ├── tsup.config.ts
│   │   └── src/
│   │       ├── index.ts
│   │       ├── primitives/
│   │       ├── forms/
│   │       ├── hooks/
│   │       └── layout/
│   │
│   ├── admin-next/                  # @vexcms/admin-next
│   │   ├── package.json
│   │   ├── tsconfig.json
│   │   └── src/
│   │       ├── index.ts
│   │       └── components/
│   │
│   └── cli/                         # @vexcms/cli (Phase C)
│       ├── package.json
│       ├── tsconfig.json
│       └── src/
│           ├── cli.ts
│           └── commands/
│               └── sync.ts
│
├── turbo.json
├── pnpm-workspace.yaml
├── package.json
├── .npmrc
└── agent-os/                        # Agent docs (excluded from workspace)
    ├── product/
    ├── standards/
    └── specs/
```

**Generated by CLI (Phase C):**

```
apps/test-app/convex/
├── vex.schema.ts          # AUTO-GENERATED - DO NOT EDIT
├── schema.ts              # User-owned, imports from vex.schema.ts
└── vex/
    └── index.ts           # Admin CRUD handlers
```

## Verification

### Phase A + B
- [ ] `pnpm install` succeeds
- [ ] `pnpm build` compiles all packages
- [ ] `pnpm --filter test-app dev` runs
- [ ] `/admin` route renders Vex shell

### Phase C (Convex Integration)
- [ ] `vex sync` generates `convex/vex.schema.ts`
- [ ] `vex sync` creates/updates `convex/schema.ts`
- [ ] `convex dev` starts without schema errors
- [ ] Adding collection to `vex.config.ts` updates both schema files
- [ ] `vex sync --watch` detects changes and regenerates

## References

- `IMPLEMENTATION-PLAN.md` — Code examples
- `setup-guide.md` — Edge cases and gotchas
- `shape.md` — Shaping decisions
