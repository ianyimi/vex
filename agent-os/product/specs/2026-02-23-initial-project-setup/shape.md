# Initial Project Setup — Shaping Notes

## Scope

Setting up the Vex CMS monorepo from scratch with minimal packages needed to:
1. Build and test the admin shell UI
2. Verify the installation flow via a test app
3. Establish the foundation for incremental feature development

## Decisions

- **Monorepo root**: `/Users/zaye/Documents/Projects/vex.git/dev/`
- **Agent docs excluded**: `agent-os/` folder is NOT part of pnpm workspace (contains product/, standards/, specs/)
- **Test app approach**: Run `pnpm create z3@latest` inside `apps/` folder, then add Vex workspace deps
- **Incremental build**: Only create folders/files needed for each phase—no empty placeholder folders
- **CLI deferred**: Phase D (create-vexcms CLI) comes after installation flow is validated

## Context

- **Visuals**: None required for this setup phase
- **References**:
  - `IMPLEMENTATION-PLAN.md` — Contains code examples
  - `00-monorepo-setup-spec.md` — Full monorepo specification
  - `03-admin-shell-spec.md` — Admin shell UI details
  - create-z3-app repository — Base template for test app
- **Product alignment**: Follows mission to be "leaner architecture" with incremental feature delivery

## Standards Applied

- **global/tech-stack** — pnpm, Turborepo, TypeScript, tsup
- **global/conventions** — @vexcms/* namespace, workspace:* protocol
- **testing/unit-tests** — Vitest configuration (added in later phase)

## Packages Created in This Phase

| Package | Purpose | Published |
|---------|---------|-----------|
| @vexcms/tsconfig | Shared TypeScript configs | No (private) |
| @vexcms/core | Schema types, defineConfig (no React) | Yes |
| @vexcms/ui | Shared React components (forms, primitives, layout) | Yes |
| @vexcms/admin-next | Admin shell for Next.js | Yes |
| @vexcms/cli | Schema sync CLI (`vex sync`) | Yes |

**Package Responsibilities:**
- `@vexcms/core` — Types, schema, config (no React dependency)
- `@vexcms/ui` — Shared React components: primitives (shadcn), form fields (TanStack Form), hooks (Legend State), layout (Layout, Header)
- `@vexcms/admin-next` — Next.js routing, server components, Sidebar (uses next/link)
- `@vexcms/cli` — Schema generation and sync commands (`vex sync`, `vex sync --watch`)

**Note:** `@vexcms/admin-tanstack-start` will be added in Phase 4, also importing from `@vexcms/ui`.

## Convex Schema Approach

Vex uses a **two-file schema approach** for hot-reloading during development:

1. **`convex/vex.schema.ts`** — Auto-generated by `vex sync`, regenerated on config changes (DO NOT EDIT)
2. **`convex/schema.ts`** — User-owned, imports from vex.schema.ts, can extend with custom tables/indexes

This allows:
- Hot reloading: `vex sync --watch` regenerates schema when vex.config.ts changes
- User customization: Add custom tables, indexes without losing them on sync
- Controlled updates: `autoUpdateSchema` setting controls automatic schema.ts updates

## What's NOT in This Phase

- Field implementations (text, number, select, etc.)
- Convex handlers (@vexcms/convex)
- Admin form components
- Authentication/auth adapter
- Live preview
- create-vexcms CLI (scaffolding new projects)
